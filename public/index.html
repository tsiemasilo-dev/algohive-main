<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AlgoHive — Where Smart Capital Gathers</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" href="/favicon.png">
  <link rel="icon" href="/favicon.png" sizes="any">

  <style> 
    /* General Styles & Fixes */
    :root { --olive:#7e8d52; --olive-700:#576138; --ink:#0B1215; --muted:#525A67 }
    html, body { 
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu; 
      background: #FFF; 
      color: #111827;
      width: 100%;
      overflow-x: hidden; /* Prevents horizontal scrolling */ 
    }
    .grid-bg { background-image: radial-gradient(rgba(69,98,67,.08) 1px, transparent 1px); background-size: 18px 18px; background-position: -10px -10px } 
    .btn-shine { position: relative; overflow: hidden }
    .btn-shine:before { content: ""; position: absolute; inset: 0; background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,.7) 50%, transparent 100%); transform: translateX(-120%) }
    .btn-shine:hover:before { transform: translateX(120%); transition: transform .8s ease }
    .glass { position: relative; background: rgba(255,255,255,0.4); border: 1px solid rgba(255,255,255,0.35); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px) }
    .glass:before { content: ""; position: absolute; inset: 0; pointer-events: none; background: linear-gradient(180deg, rgba(255,255,255,.35), rgba(255,255,255,0)); border-radius: inherit; opacity: .8 }
    .metric-card { transition: transform .25s ease, background-color .25s ease, color .25s ease, box-shadow .25s ease, border-color .25s ease; will-change: transform }
    .metric-card:hover { transform: translateY(-2px) scale(1.03) }
    
    /* TradingView Ticker Fixes */
    .tv-ticker .tradingview-widget-container__widget { height: 56px !important }
    .tv-ticker .tradingview-widget-copyright { display: none }
    @media (max-width: 640px) { .tv-ticker .tradingview-widget-container__widget { height: 52px !important } }

    /* Hero entrance animations + highlight */
    .hero-right { animation: heroScaleIn .9s cubic-bezier(.2,.8,.2,1) .05s both }
    .hero-left { animation: heroSlideUp .7s ease-out 1.0s both }
    @keyframes heroScaleIn { 0% { transform: scale(1.12); opacity: 0 } 100% { transform: scale(1); opacity: 1 } }
    @keyframes heroSlideUp { 0% { transform: translateY(12px); opacity: 0 } 100% { transform: translateY(0); opacity: 1 } }
    .highlight { background-image: linear-gradient(0deg, rgba(126,141,82,.28), rgba(126,141,82,.28)); background-size: 0% 100%; background-repeat: no-repeat; border-radius: .25rem; padding: 0 .2em; animation: sweep 1.2s ease-out 1.3s forwards }
    @keyframes sweep { to { background-size: 100% 100% } }

    /* New styles for strategy filters */
    @keyframes swapIn { from {opacity:0; transform: translateY(8px) scale(.98)} to {opacity:1; transform: translateY(0) scale(1)} }
    .swap-in { animation: swapIn .45s cubic-bezier(.2,.8,.2,1) both }
    .tag-active, .prd-active { background: var(--olive); color: #fff; }
    .prd-active:hover { background: var(--olive-700); }
    .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
    
    /* Fix period button states */
    .prd:focus { outline: none; }
    .prd:active { background: var(--olive); color: #fff; }
    .prd-active:focus { background: var(--olive); color: #fff; }
    .prd-active:active { background: var(--olive-700); color: #fff; }

 
    #strategyBar {
      transition: all 0.3s ease;
      cursor: pointer;
      border-radius: 1rem;
      padding: 1rem;
      margin: 1.5rem -1rem;
    }
    #strategyBar.clicked {
      background: rgba(126, 141, 82, 0.1);
      border: 2px solid var(--olive);
      box-shadow: 0 4px 12px rgba(126, 141, 82, 0.2);
    }
    #strategyBar:hover {
      background: rgba(126, 141, 82, 0.05);
    }
    
    /* ***** ADDED: Styles for Performance Summary box from strategy.html ***** */
    .ps-tile {
        border: 1px solid #e5e7eb;
        border-radius: 14px;
        padding: 14px 16px;
        background: #fff
    }
    .ps-label {
        color: #64748b;
        font-weight: 500;
        font-size: .85rem
    }
    .ps-value {
        font-weight: 600;
        font-size: 1rem;
        margin-top: 2px;
        /* ***** ADDED: Default color transition ***** */
        color: var(--ink);
        transition: color 0.2s;
    }
    /* ***** END OF ADDED STYLES ***** */
    
  </style>
  <script nonce="ALGOHIVE">
    window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>
</head>
<body class="grid-bg">

  <section class="relative min-h-[100svh] flex flex-col pb-24">
    <div class="pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 h-96 w-full max-w-[80rem] bg-[radial-gradient(ellipse_at_center,rgba(69,98,67,.12),transparent_55%)]"></div>

    <header class="w-full sticky top-3 z-50 px-3 sm:px-4 lg:px-6">
      <div class="mx-auto max-w-5xl">
        <nav aria-label="Primary" class="relative flex items-center justify-between gap-2 rounded-full border border-black/10 bg-white px-3 py-2 shadow-lg">
          <a href="index.html" class="flex flex-shrink-0 items-center gap-2 rounded-full px-2 py-1.5 hover:bg-black/5">
            <img src="https://static.wixstatic.com/media/ac771e_af06d86a7a1f4abd87e52e45f3bcbd96~mv2.png" alt="AlgoHive logo" class="h-7 w-auto">
            <span class="hidden md:inline text-sm font-extrabold tracking-tight text-[var(--ink)]">AlgoHive</span>
          </a>

          <div class="hidden md:flex items-center gap-1">
            <span class="h-6 w-px bg-black/10 mx-1"></span>
            <a href="who-we-are.html" class="px-3 py-2 rounded-full text-sm font-medium text-[var(--ink)] hover:bg-black/5">Who We Are</a>
            <a href="how-we-work.html" class="px-3 py-2 rounded-full text-sm font-medium text-[var(--ink)] hover:bg-black/5">How We Work</a>
            <a href="#pricing" class="px-3 py-2 rounded-full text-sm font-medium text-[var(--ink)] hover:bg-black/5">Pricing</a>
            <a href="#faqs" class="px-3 py-2 rounded-full text-sm font-medium text-[var(--ink)] hover:bg-black/5">FAQs</a>
          </div>

          <div class="flex items-center gap-2">
            <a href="/auth.html?redirect=/home.html" class="btn-shine inline-flex items-center gap-2 rounded-full bg-[var(--olive)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--olive-700)]">Login</a>
            <a href="#strategies" class="hidden sm:inline-flex items-center gap-2 rounded-full border border-black/15 px-4 py-2 text-sm font-semibold text-[var(--ink)] hover:bg-black/5">View OpenStrategies</a>
            <button id="hamburger-button" class="md:hidden p-2 rounded-full hover:bg-black/5">
              <svg class="w-6 h-6 text-[var(--ink)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
          </div>
          
          <div id="mobile-menu" class="hidden md:hidden absolute top-full right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-black/10">
            <a href="who-we-are.html" class="block px-4 py-2 text-sm text-[var(--ink)] hover:bg-black/5">Who We Are</a>
            <a href="how-we-work.html" class="block px-4 py-2 text-sm text-[var(--ink)] hover:bg-black/5">How We Work</a>
            <a href="#pricing" class="block px-4 py-2 text-sm text-[var(--ink)] hover:bg-black/5">Pricing</a>
            <a href="#faqs" class="block px-4 py-2 text-sm text-[var(--ink)] hover:bg-black/5">FAQs</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6 flex-1 flex flex-col">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-10 items-center grow py-8 lg:py-12">
        <div class="lg:col-span-6 hero-left">
          <span id="inviteTag" class="inline-flex items-center gap-2 rounded-full border border-black/10 bg-black/[0.03] px-3 py-1 text-xs text-black/60">
            Beta Now Live
          </span>
          <h1 id="heroTitle" class="mt-5 text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold leading-tight text-[var(--ink)]">
            Elevate your investment portfolio with AlgoHive
          </h1>

          <p id="heroDescription" class="mt-5 text-base sm:text-lg text-[var(--muted)] max-w-xl">
            Ready-made investment strategies, managed like funds. Built to grow your wealth, not fees.
          </p>

          <div class="mt-8 flex flex-wrap items-center gap-4">
            <a href="/auth.html?redirect=/home.html" class="btn-shine inline-flex items-center gap-2 rounded-xl bg-[var(--olive)] px-6 py-3 font-semibold text-white hover:bg-[var(--olive-700)]">
              Start for Free
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5"><path d="M13.5 4.5 21 12l-7.5 7.5M21 12H3"/></svg>
            </a>
            <a href="/home.html" class="inline-flex items-center gap-2 rounded-xl border border-black/15 px-6 py-3 font-semibold text-[var(--ink)] hover:bg-black/5">
              Invest Real Money
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-6-6h12"/></svg>
            </a>
          </div>
        </div>

        <div class="lg:col-span-6 hero-right relative flex items-center justify-center min-h-[360px] sm:min-h-[440px]">
          <div id="logoSphere" class="w-full h-full flex items-center justify-center"></div>
        </div>
      </div>
    </main>
    <div class="w-full absolute inset-x-0 bottom-4 z-40">
      <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6">
        <div class="tv-ticker glass rounded-full border border-black/10 shadow-lg overflow-hidden">
          <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async nonce="ALGOHIVE">
            {
              "symbols": [
                { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
                { "proName": "FOREXCOM:NSXUSD", "title": "US 100" },
                { "proName": "FX_IDC:EURUSD",   "title": "EUR/USD" },
                { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
                { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" }
              ],
              "colorTheme": "light",
              "isTransparent": true,
              "displayMode": "adaptive",
              "showSymbolLogo": true,
              "locale": "en"
            }
            </script>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script type="text/babel" nonce="ALGOHIVE">
    const { useEffect, useRef, useState } = React;

    const SUPABASE_URL = "https://aazofjsssobejhkyyiqv.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFhem9manNzc29iZWpoa3l5aXF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMTI1NDUsImV4cCI6MjA3MzY4ODU0NX0.guYlxaV5RwTlTVFoUhpER0KWEIGPay8svLsxMwyRUyM";

    const defaultSphereImages = [
      { id: "apple", src: "https://logo.clearbit.com/apple.com" },
      { id: "microsoft", src: "https://logo.clearbit.com/microsoft.com" },
      { id: "google", src: "https://logo.clearbit.com/google.com" },
      { id: "amazon", src: "https://logo.clearbit.com/amazon.com" },
      { id: "nvidia", src: "https://logo.clearbit.com/nvidia.com" },
      { id: "meta", src: "https://logo.clearbit.com/meta.com" },
      { id: "visa", src: "https://logo.clearbit.com/visa.com" },
      { id: "netflix", src: "https://logo.clearbit.com/netflix.com" },
      { id: "jpmorgan", src: "https://logo.clearbit.com/jpmorganchase.com" },
      { id: "coca-cola", src: "https://logo.clearbit.com/coca-cola.com" },
      { id: "nike", src: "https://logo.clearbit.com/nike.com" },
      { id: "disney", src: "https://logo.clearbit.com/disney.com" },
      { id: "naspers", src: "https://s3-symbol-logo.tradingview.com/naspers--big.svg" },
      { id: "capitec", src: "https://s3-symbol-logo.tradingview.com/capitec-bank-hldgs-ltd--big.svg" },
      { id: "mtn", src: "https://logo.clearbit.com/mtn.com" },
      { id: "vodacom", src: "https://s3-symbol-logo.tradingview.com/vodafone--big.svg" },
      { id: "discovery", src: "https://logo.clearbit.com/discovery.co.za" },
      { id: "bitcoin", src: "https://cryptologos.cc/logos/bitcoin-btc-logo.png" },
      { id: "ethereum", src: "https://cryptologos.cc/logos/ethereum-eth-logo.png" },
      { id: "solana", src: "https://cryptologos.cc/logos/solana-sol-logo.png" },
      { id: "shoprite", src: "https://logo.clearbit.com/shoprite.co.za" },
      { id: "picknpay", src: "https://logo.clearbit.com/picknpay.co.za" },
      { id: "woolworths", src: "https://logo.clearbit.com/woolworths.co.za" },
      { id: "sasol", src: "https://logo.clearbit.com/sasol.com" },
      { id: "anglo-american", src: "https://logo.clearbit.com/angloamerican.com" },
      { id: "sanlam", src: "https://logo.clearbit.com/sanlam.co.za" },
      { id: "bidvest", src: "https://logo.clearbit.com/bidvest.com" },
      { id: "mastercard", src: "https://logo.clearbit.com/mastercard.com" },
    ];

    const supabase = window.supabase?.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    const TRADING_LOGOS_KEY = "ah_trading_universe_logos";

    const normalizeLogos = (rows) => {
      const seen = new Set();

      return rows
        .map((row) => ({
          id: (row.symbol || `logo-${row.id}`).toLowerCase(),
          src: row.logo,
        }))
        .filter((row) => typeof row.src === 'string' && row.src.trim().startsWith('http'))
        .filter(({ src }) => {
          if (seen.has(src)) return false;
          seen.add(src);
          return true;
        });
    };

    const fetchCachedLogos = () => {
      try {
        const cached = sessionStorage.getItem(TRADING_LOGOS_KEY);
        if (!cached) return null;

        const parsed = JSON.parse(cached);
        const cachedLogos = normalizeLogos(
          parsed?.source === 'trading_universe' && Array.isArray(parsed.logos)
            ? parsed.logos
            : []
        );

        return cachedLogos.length ? cachedLogos : null;
      } catch (err) {
        console.warn("Unable to read cached trading logos", err);
        return null;
      }
    };

    async function fetchTradingLogos() {
      const cached = fetchCachedLogos();
      if (cached) return cached;

      if (!supabase) return defaultSphereImages;

      const { data, error } = await supabase
        .from('trading_universe')
        .select('id, symbol, logo')
        .not('logo', 'is', null)
        .neq('logo', '')
        .order('symbol', { ascending: true })
        .limit(120);

      if (error || !data?.length) return defaultSphereImages;

      const logos = normalizeLogos(data);

      if (logos.length) {
        try {
          sessionStorage.setItem(
            TRADING_LOGOS_KEY,
            JSON.stringify({ source: 'trading_universe', logos })
          );
        } catch (err) {
          console.warn("Unable to cache trading logos", err);
        }
      }

      return logos.length ? logos : defaultSphereImages;
    }

    const Sphere = ({ images, size = 760 }) => {
      const [rot, setRot] = useState({ x: 15, y: 0 });
      const [vel, setVel] = useState({ x: 0, y: 0 });
      const [dragging, setDragging] = useState(false);
      const [points, setPoints] = useState([]);
      const last = useRef({ x: 0, y: 0 });

      const radius = size * 0.45;
      const baseSize = size * 0.14;

      useEffect(() => {
        const pts = [];
        const count = images.length;
        const phi = Math.PI * (3 - Math.sqrt(5));

        for (let i = 0; i < count; i++) {
          const y = 1 - (i / (count - 1)) * 2;
          const r = Math.sqrt(1 - y * y);
          const theta = phi * i;
          pts.push({
            x: Math.cos(theta) * r * radius,
            y: y * radius,
            z: Math.sin(theta) * r * radius,
          });
        }
        setPoints(pts);
      }, [images.length, radius]);

      useEffect(() => {
        let id;
        const loop = () => {
          if (!dragging) {
            setVel((v) => ({ x: v.x * 0.97, y: v.y * 0.97 }));
            setRot((r) => ({
              x: r.x + vel.x,
              y: r.y + vel.y + 0.1,
            }));
          }
          id = requestAnimationFrame(loop);
        };
        id = requestAnimationFrame(loop);
        return () => cancelAnimationFrame(id);
      }, [dragging, vel.x, vel.y]);

      const start = (e) => {
        setDragging(true);
        setVel({ x: 0, y: 0 });
        const x = e.clientX || e.touches?.[0]?.clientX || 0;
        const y = e.clientY || e.touches?.[0]?.clientY || 0;
        last.current = { x, y };
      };

      const move = (e) => {
        if (!dragging) return;
        const x = e.clientX || e.touches?.[0]?.clientX || 0;
        const y = e.clientY || e.touches?.[0]?.clientY || 0;
        const dx = x - last.current.x;
        const dy = y - last.current.y;

        setRot((r) => ({
          x: r.x - dy * 0.45,
          y: r.y + dx * 0.45,
        }));
        setVel({ x: -dy * 0.35, y: dx * 0.35 });
        last.current = { x, y };
      };

      const end = () => setDragging(false);

      const project = (p) => {
        let { x, y, z } = p;
        const rx = (rot.x * Math.PI) / 180;
        const ry = (rot.y * Math.PI) / 180;

        const tx = x * Math.cos(ry) + z * Math.sin(ry);
        z = -x * Math.sin(ry) + z * Math.cos(ry);
        x = tx;

        const ty = y * Math.cos(rx) - z * Math.sin(rx);
        z = y * Math.sin(rx) + z * Math.cos(rx);
        y = ty;

        const scale = 1 + z / (radius * 3);
        const visible = z > -radius * 0.7;

        return {
          x,
          y,
          scale: Math.max(0.45, scale),
          visible,
          opacity: visible ? Math.max(0.5, (z + radius) / (radius * 1.5)) : 0,
          zIndex: Math.round(z),
        };
      };

      return (
        <div
          className={`relative ${dragging ? "cursor-grabbing" : "cursor-grab"} select-none`}
          style={{ width: size, height: size }}
          onMouseDown={start}
          onMouseMove={move}
          onMouseUp={end}
          onMouseLeave={end}
          onTouchStart={start}
          onTouchMove={move}
          onTouchEnd={end}
        >
          {points.map((p, i) => {
            const proj = project(p);
            if (!proj.visible) return null;
            const s = baseSize * proj.scale;

            return (
              <div
                key={images[i].id}
                className="absolute"
                style={{
                  width: s,
                  height: s,
                  left: size / 2 + proj.x,
                  top: size / 2 + proj.y,
                  transform: "translate(-50%, -50%)",
                  opacity: proj.opacity,
                  zIndex: 1000 + proj.zIndex,
                }}
              >
                <div className="w-full h-full rounded-full overflow-hidden shadow-2xl bg-white p-4">
                  <img
                    src={images[i].src}
                    className="w-full h-full object-contain"
                    draggable={false}
                    loading="lazy"
                    alt={images[i].id}
                  />
                </div>
              </div>
            );
          })}
        </div>
      );
    };

    const getSphereSize = () => {
      const width = window.innerWidth;
      if (width >= 1280) return 740;
      if (width >= 1024) return 620;
      if (width >= 768) return 520;
      return 380;
    };

    const SphereWrapper = () => {
      const [size, setSize] = useState(getSphereSize());
      const [images, setImages] = useState(defaultSphereImages);

      useEffect(() => {
        const handleResize = () => setSize(getSphereSize());
        window.addEventListener('resize', handleResize);
        return () => window.removeEventListener('resize', handleResize);
      }, []);

      useEffect(() => {
        let isMounted = true;

        fetchTradingLogos()
          .then((logos) => {
            if (isMounted && logos?.length) {
              setImages(logos);
            }
          })
          .catch(() => {
            /* fallback stays as defaultSphereImages */
          });

        return () => {
          isMounted = false;
        };
      }, []);

      return <Sphere images={images} size={size} />;
    };

    const mountNode = document.getElementById('logoSphere');
    if (mountNode) {
      ReactDOM.createRoot(mountNode).render(<SphereWrapper />);
    }

    const params = new URLSearchParams(window.location.search);
    const friendParam = params.get('Friend') ?? params.get('friend');
    const heroTitle = document.getElementById('heroTitle');
    const heroDescription = document.getElementById('heroDescription');
    const inviteTag = document.getElementById('inviteTag');

    if (friendParam && friendParam.trim()) {
      const cleanedFriend = friendParam.trim().replace(/^['"]+|['"]+$/g, '');
      const friendName = cleanedFriend.slice(0, 60) || 'A friend';
      const inviteLine = `${friendName} thinks you’re investment-material.`;

      if (heroTitle) {
        heroTitle.innerHTML = '';

        const friendEl = document.createElement('span');
        friendEl.className = 'highlight';
        friendEl.textContent = friendName;

        heroTitle.appendChild(friendEl);
        heroTitle.appendChild(document.createTextNode(' thinks you’re investment-material.'));
      }

      if (heroDescription) {
        heroDescription.innerHTML = 'So, Welcome to AlgoHive, ready-made investment strategies, managed like funds. <span class="highlight">Accept the invite and start building your portfolio on your terms</span>.';
      }

      if (inviteTag) inviteTag.textContent = `${friendName} invited you`;
      document.title = inviteLine;
    }
  </script>

  <section id="strategies" class="py-12 lg:py-16">
    <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6">
      <div class="max-w-3xl">
      <h2 class="mt-0 text-4xl sm:text-5xl font-extrabold tracking-tight text-[var(--ink)]">
        Build your portfolio with our <span class="text-[var(--olive)]">managed</span> strategies.
      </h2>
      <p class="mt-4 sm:mt-5 text-base sm:text-lg text-[var(--muted)]">
        Allocate to strategies that suit your goal and risk appetite. <span class="highlight">No AUM fees — we win when you do.</span>
      </p>
    </div>
        <div id="strategyBar" class="mt-8 sm:mt-10 flex flex-col sm:flex-row items-start sm:items-center gap-4">

            <div id="assetFilters" class="flex flex-wrap items-center gap-2 rounded-full border border-black/10 bg-white p-1">
                </div>

<div id="strategyNav" class="hidden"></div>


            <div class="ml-0 sm:ml-auto flex items-center gap-1 rounded-full border border-black/10 bg-white p-1">
                <button class="prd px-3 py-1.5 rounded-full text-xs font-medium text-[var(--ink)] hover:bg-black/5 prd-active" data-period="6M">6M</button>
                <button class="prd px-3 py-1.5 rounded-full text-xs font-medium text-[var(--ink)] hover:bg-black/5" data-period="1Y">1Y</button>
                <button class="prd px-3 py-1.5 rounded-full text-xs font-medium text-[var(--ink)] hover:bg-black/5" data-period="ALL">All</button>
            </div>
        </div>

        <div class="relative mt-10">
            <article id="leftCard" class="swap-in rounded-3xl border border-black/10 bg-gradient-to-b from-white to-slate-50 p-6 shadow-[0_6px_24px_rgba(0,0,0,0.06)]">
                <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
                    <div class="min-w-0">
                        <div class="flex items-center gap-2 text-xs text-slate-500">
                            <span id="period">All time</span>
                        </div>
                        <h3 id="stratName" class="text-[28px] leading-tight font-semibold truncate">—</h3>
                        <div class="flex flex-wrap items-center gap-2 mt-1 text-sm text-slate-600">
                            <span id="provider">—</span><span>•</span>
                            <span id="since">Live since —</span><span>•</span>
                            <span id="currency">USD</span>
                            <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] bg-slate-50 text-slate-700" id="risk">Risk —</span>
                            <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] bg-emerald-50 text-emerald-700 hidden" id="aum">AUM —</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 text-xs">
                        <span class="inline-flex items-center gap-2"><span class="inline-block h-2 w-2 rounded-full" style="background:#556B2F"></span> Portfolio</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-5">
                    <div class="lg:col-span-8 xl:col-span-9">
                        <div class="flex items-center justify-between gap-3 mb-3">
                            <div class="flex items-center gap-2">
                                <div class="text-2xl font-semibold" id="eqValue">—</div>
                                <span id="eqDelta" class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] bg-green-50 text-green-700">+0.0%</span>
                            </div>
                            <div class="text-xs text-slate-500">* return vs period start</div>
                        </div>

                        <div class="relative w-full h-[320px] overflow-hidden rounded-2xl border bg-white">
                            <canvas id="equityChartCanvas" class="max-w-full"></canvas>
                        </div>
                    </div>

                    <div class="lg:col-span-4 xl:col-span-3">
                        <div id="eqMetrics" class="grid grid-cols-2 gap-3 text-sm">
                            <div class="ps-tile">
                                <div class="ps-label">Best Day</div>
                                <div id="mBestDay" class="ps-value">—</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Worst Day</div>
                                <div id="mWorstDay" class="ps-value">—</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Avg Daily Return</div>
                                <div id="mAvgDaily" class="ps-value">—</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Positive Days</div>
                                <div id="mPosDays" class="ps-value">—</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">Trading Days</div>
                                <div id="mTradingDays" class="ps-value">—</div>
                            </div>
                            <div class="ps-tile">
                                <div class="ps-label">YTD</div>
                                <div id="mYTD" class="ps-value">—</div>
                            </div>
                        </div>
                        <p id="stratDesc" class="mt-3 text-[12px] leading-5 text-slate-700">—</p>
                    </div>
                </div>
            </article>
        </div>

        <p class="mt-8 text-xs text-black/50">
            Strategy stats are illustrative. Performance isn’t guaranteed. Fees apply to returns, <span class="highlight">not AUM</span>.
        </p>
    </div>
  </section>

<section id="lending" class="relative flex flex-col justify-center py-12 lg:py-16">
  <div class="pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 h-96 w-[80rem] bg-[radial-gradient(ellipse_at_center,rgba(69,98,67,.12),transparent_55%)]"></div>

  <div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold tracking-tight text-[var(--ink)]">
        Portfolio-Backed <span class="text-[var(--olive)]">Lending</span>
      </h2>
      <p class="mt-3 text-[15px] sm:text-lg text-[var(--muted)]">
        Leverage your investments to access smarter credit. Pledge your portfolio to unlock lower-cost borrowing without selling your holdings, reducing tax impact and staying invested in market opportunities. Pay less on credit while keeping your growth potential intact.
      </p>
    </div>

    <div class="mt-10 grid grid-cols-1 lg:grid-cols-12 gap-6">
      <article class="lg:col-span-7 rounded-3xl border border-black/10 bg-gradient-to-b from-white to-slate-50 p-6 shadow-[0_6px_24px_rgba(0,0,0,0.06)]">
        <div class="flex items-center justify-between">
          <div>
            <span class="inline-flex items-center gap-2 rounded-full border border-black/10 bg-black/[0.03] px-3 py-1 text-xs text-black/60">
              Portfolio-backed credit
            </span>
            <h3 class="mt-2 text-xl font-bold text-[var(--ink)]">Estimate your borrowing power</h3>
          </div>
          <div class="hidden sm:flex items-center gap-2 text-xs text-slate-600">
            <span class="inline-flex items-center gap-1 rounded-full bg-emerald-50 text-emerald-700 px-2 py-0.5 border border-emerald-200">Stay invested</span>
            <span class="inline-flex items-center gap-1 rounded-full bg-amber-50 text-amber-700 px-2 py-0.5 border border-amber-200">No forced selling</span>
          </div>
        </div>

        <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
          <label class="block">
            <span class="text-xs text-slate-600">Portfolio value (ZAR)</span>
            <div class="mt-1 flex items-center gap-2 rounded-xl border border-black/10 bg-white px-3 py-2">
              <span class="text-slate-400">R</span>
              <input id="pv" type="number" min="10000" step="1000" value="250000"
                     class="w-full outline-none text-[var(--ink)]" />
            </div>
          </label>

          <label class="block">
            <span class="text-xs text-slate-600">Term</span>
            <select id="term" class="mt-1 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-[var(--ink)]">
              <option value="6">6 months</option>
              <option value="12" selected>12 months</option>
              <option value="24">24 months</option>
              <option value="36">36 months</option>
            </select>
          </label>

          <div class="sm:col-span-2">
            <div class="flex items-center justify-between">
              <span class="text-xs text-slate-600">Loan-to-Value (LTV)</span>
              <span id="ltvLabel" class="text-xs font-medium text-[var(--ink)]">40%</span>
            </div>
            <input id="ltv" type="range" min="30" max="60" step="1" value="40"
                   class="mt-2 w-full accent-[var(--olive)]" />
            <div class="mt-1 flex justify-between text-[11px] text-slate-500">
              <span>30%</span><span>45%</span><span>60%</span>
            </div>
          </div>
        </div>

        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="glass rounded-2xl p-4 ring-1 ring-white/30">
            <div class="text-xs text-black/60">Estimated rate (APR)</div>
            <div id="aprOut" class="mt-1 text-2xl font-semibold text-[var(--ink)]">—</div>
            <div class="mt-1 text-[11px] text-slate-500">Varies with LTV</div>
          </div>
          <div class="glass rounded-2xl p-4 ring-1 ring-white/30">
            <div class="text-xs text-black/60">Borrow amount</div>
            <div id="borrowOut" class="mt-1 text-2xl font-semibold text-[var(--ink)]">—</div>
            <div class="mt-1 text-[11px] text-slate-500">Up to 60% LTV</div>
          </div>
          <div class="glass rounded-2xl p-4 ring-1 ring-white/30">
            <div class="text-xs text-black/60">Monthly payment (est.)</div>
            <div id="payOut" class="mt-1 text-2xl font-semibold text-[var(--ink)]">—</div>
            <div class="mt-1 text-[11px] text-slate-500">Amortising</div>
          </div>
        </div>

        <div class="mt-6 flex flex-wrap items-center gap-3">
          <button disabled class="inline-flex w-full sm:w-auto items-center justify-center gap-2 rounded-xl bg-slate-200 px-6 py-3 font-semibold text-slate-500 cursor-not-allowed">
              Application Coming Soon
          </button>
          <span class="text-[11px] text-slate-500">Illustrative only. Final terms subject to assessment.</span>
        </div>
      </article>

      <aside class="lg:col-span-5 rounded-3xl border border-black/10 bg-white p-6 shadow-[0_6px_24px_rgba(0,0,0,0.06)]">
        <h4 class="text-lg font-bold text-[var(--ink)]">Why portfolio-backed credit?</h4>
        <ul class="mt-3 space-y-3 text-sm text-[var(--ink)]">
          <li class="flex items-start gap-3">
            <span class="mt-1 h-2 w-2 rounded-full bg-[var(--olive)]"></span>
            <div><span class="font-semibold">Stay invested.</span> Borrow without selling assets or disrupting compounding.</div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 h-2 w-2 rounded-full bg-[var(--olive)]"></span>
            <div><span class="font-semibold">Lower cost vs unsecured.</span> Secured against your portfolio for competitive rates.</div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 h-2 w-2 rounded-full bg-[var(--olive)]"></span>
            <div><span class="font-semibold">Flexible terms.</span> Choose LTV and term that fit your cash-flow.</div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 h-2 w-2 rounded-full bg-[var(--olive)]"></span>
            <div><span class="font-semibold">Fast process.</span> Streamlined digital onboarding and pledge.</div>
          </li>
        </ul>

        <div class="mt-6 grid grid-cols-3 gap-3">
          <div class="glass rounded-xl p-3 text-center ring-1 ring-white/30">
            <div class="text-[11px] text-black/60">Max LTV</div>
            <div class="text-lg font-semibold text-[var(--ink)]">60%</div>
          </div>
          <div class="glass rounded-xl p-3 text-center ring-1 ring-white/30">
            <div class="text-[11px] text-black/60">Terms</div>
            <div class="text-lg font-semibold text-[var(--ink)]">6–36 mo</div>
          </div>
          <div class="glass rounded-xl p-3 text-center ring-1 ring-white/30">
            <div class="text-[11px] text-black/60">Use cases</div>
            <div class="text-lg font-semibold text-[var(--ink)]">Growth / Liquidity</div>
          </div>
        </div>

        <div class="mt-6 rounded-2xl border border-black/10 bg-black/[0.03] p-4 text-xs text-slate-600">
          Collateral held with partner custodians. Rates and limits depend on asset mix, volatility and concentration. Not financial advice.
        </div>
      </aside>
    </div>
  </div>

  <script nonce="ALGOHIVE">
    (function(){
      const $ = (s)=>document.querySelector(s);
      const fmt = new Intl.NumberFormat('en-ZA', { style:'currency', currency:'ZAR', maximumFractionDigits:0 });

      const pv = $('#pv'), term = $('#term'), ltv = $('#ltv'), ltvLabel = $('#ltvLabel');
      const aprOut = $('#aprOut'), borrowOut = $('#borrowOut'), payOut = $('#payOut');

      const line = $('#lendLinePath'), fill = $('#lendFill');

      function aprFromLTV(x){
        // illustrative rate curve: base 12% APR + 0.25% per 1% LTV over 30
        return 0.12 + Math.max(0, (x - 30)) * 0.0025;
      }

      function pmnt(principal, apr, months){
        if (months <= 0) return 0;
        const r = apr / 12;
        if (r === 0) return principal / months;
        return principal * (r / (1 - Math.pow(1 + r, -months)));
      }

      function drawBalance(principal, apr, months){
        const W = 720, H = 160, P = 10;
        const r = apr/12;
        let bal = principal, y = [];
        for (let m=0; m<=months; m++){
          y.push(bal);
          const pay = pmnt(principal, apr, months);
          const interest = bal * r;
          const amort = Math.max(0, pay - interest);
          bal = Math.max(0, bal - amort);
        }
        const max = principal, min = 0;
        const nx = i => P + (i*(W-2*P))/months;
        const ny = v => H-P - ((v-min)/(max-min||1))*(H-2*P);
        const d = 'M ' + y.map((v,i)=>`${nx(i)},${ny(v)}`).join(' L ');
        line.setAttribute('d', d);
        const fillD = `${d} L ${nx(months)},${H-P} L ${nx(0)},${H-P} Z`;
        fill.setAttribute('d', fillD);
      }

      function update(){
        const pvZar = Math.max(0, Number(pv.value)||0);
        const ltvPct = Math.max(30, Math.min(60, Number(ltv.value)||40));
        ltvLabel.textContent = ltvPct + '%';

        const principal = pvZar * (ltvPct/100);
        const months = Number(term.value)||12;
        const apr = aprFromLTV(ltvPct);

        const pay = pmnt(principal, apr, months);

        aprOut.textContent = (apr*100).toFixed(1) + '%';
        borrowOut.textContent = fmt.format(principal);
        payOut.textContent = fmt.format(pay);

        drawBalance(principal, apr, months);
      }

      pv.addEventListener('input', update);
      term.addEventListener('change', update);
      ltv.addEventListener('input', update);

      update();
    })();
  </script>
</section>

<section id="pricing" class="flex flex-col justify-center py-12 lg:py-16">
  <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6">
    <div class="relative overflow-hidden rounded-[2rem] border border-black/10 bg-white shadow-[0_6px_24px_rgba(0,0,0,0.06)]">
      <div class="pointer-events-none absolute -top-64 left-1/2 -translate-x-1/2 w-[140%] h-[420px]
                  bg-[radial-gradient(120%_140%_at_50%_0%,rgba(126,141,82,0.20),rgba(126,141,82,0.10)_40%,transparent_70%)]">
      </div>
      <div class="pointer-events-none absolute -bottom-40 left-1/2 -translate-x-1/2 w-[120%] h-[300px]
                  bg-[radial-gradient(80%_80%_at_50%_100%,rgba(126,141,82,0.10),transparent_60%)]">
      </div>

      <div class="relative px-6 sm:px-10 pt-14 text-center">
        <span class="inline-flex items-center gap-2 rounded-full border border-black/10 bg-black/[0.03] px-3 py-1 text-xs text-black/60">
          Simple, transparent pricing — no AUM fees
        </span>
        <h2 class="mt-4 text-2xl sm:text-3xl lg:text-4xl font-extrabold tracking-tight text-[var(--ink)]">
          Pick the plan that matches your goals
        </h2>
        <p class="mt-3 text-[15px] sm:text-lg text-[var(--muted)]">
          Start free. Upgrade when you’re ready. Cancel anytime.
        </p>
      </div>

<div class="relative px-6 sm:px-10 pb-12">
  <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-5 lg:gap-6 items-stretch">
    <article class="h-full flex flex-col rounded-2xl border border-black/10 bg-white p-6">
      <div class="flex items-baseline justify-between">
        <h3 class="text-lg font-bold text-[var(--ink)]">Silver</h3>
        <span class="text-xs rounded-full px-2 py-1 bg-black/[0.05] text-slate-600 border border-black/10">Silver</span>
      </div>
      <p class="mt-1 text-sm text-slate-600 leading-relaxed">Starter features for tracking and exploring.</p>
      <div class="mt-5">
        <div class="text-3xl font-extrabold">R0<span class="text-sm font-semibold text-slate-500"> / month</span></div>
      </div>
      <ul class="mt-5 space-y-3 text-sm text-[var(--ink)]">
        <li class="flex gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" class="mt-0.5"><path fill="#7e8d52" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
          Track <b>1 strategy</b>, no AUM fees
        </li>
        <li class="flex gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" class="mt-0.5"><path fill="#7e8d52" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
          Access to portfolio-linked credit (Coming Soon)
        </li>
      </ul>
      <a href="auth.html"
         class="mt-auto inline-flex w-full items-center justify-center rounded-xl border border-black/15 px-4 py-2 text-sm font-semibold text-[var(--ink)] hover:bg-black/5">
        Choose Silver
      </a>
    </article>

    <article class="relative h-full flex flex-col rounded-2xl border-2 border-[var(--olive)] bg-white p-6 shadow-[0_10px_30px_rgba(126,141,82,0.12)]">
      <div class="absolute -top-3 right-4 text-xs rounded-full bg-[var(--olive)] text-white px-2 py-0.5 shadow">Most Popular</div>
      <div class="flex items-baseline justify-between">
        <h3 class="text-lg font-bold text-[var(--ink)]">Gold</h3>
        <span class="text-xs rounded-full px-2 py-1 bg-amber-50 text-amber-700 border border-amber-200">Gold</span>
      </div>
      <p class="mt-1 text-sm text-slate-600 leading-relaxed">For growing investors who want sharper insights and multiple strategies.</p>
      <div class="mt-5">
        <div class="text-3xl font-extrabold">
          R299 <span class="text-slate-500 line-through">R450</span>
          <span class="text-sm font-semibold text-slate-500"> / month</span>
        </div>
      </div>
      <ul class="mt-5 space-y-3 text-sm text-[var(--ink)]">
        <li class="flex gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" class="mt-0.5"><path fill="#7e8d52" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
          Track up to <strong>6 strategies</strong> with no AUM fees
        </li>
        <li class="flex gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" class="mt-0.5"><path fill="#7e8d52" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
          Day-ahead newsletter (news + economic events)
        </li>
        <li class="flex gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" class="mt-0.5"><path fill="#7e8d52" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
          <b>Premium</b> Wealth Tracker Tools
        </li>
      </ul>
      <a href="auth.html"
         class="mt-auto inline-flex w-full items-center justify-center rounded-xl bg-[var(--olive)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--olive-700)] btn-shine">
        Choose Gold
      </a>
    </article>
  </div>

  <p class="mt-8 text-center text-[11px] text-slate-600">
    VAT may apply. Some perks require identity and suitability checks. No financial advice.
  </p>
</div>

    </div>
  </div>
</section>

<section id="final-cta" class="py-16 lg:py-20">
  <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6">
    <div class="overflow-hidden rounded-[2rem] border border-black/10 bg-white shadow-[0_10px_32px_rgba(0,0,0,0.08)]">
      <div class="px-6 sm:px-12 py-12 sm:py-16 text-center">
        <span class="inline-flex items-center gap-2 rounded-full border border-black/10 bg-black/[0.03] px-3 py-1 text-xs text-black/60">
          No AUM fees — we win when you do
        </span>

        <h2 class="mt-4 text-2xl sm:text-3xl lg:text-4xl font-extrabold tracking-tight text-[var(--ink)]">
          Ready to grow with <span class="text-[var(--olive)]">AlgoHive</span>?
        </h2>
        <p class="mt-3 text-[15px] sm:text-lg text-[var(--muted)]">
          Pick a strategy, track performance, and stay invested with smarter tools.
        </p>

        <div class="mt-6 flex flex-wrap items-center justify-center gap-3">
          <a href="/auth.html?redirect=/home.html"
             class="inline-flex items-center gap-2 rounded-xl bg-[var(--olive)] px-6 py-3 font-semibold text-white hover:bg-[var(--olive-700)] btn-shine">
            Create your account
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M13.5 4.5 21 12l-7.5 7.5M21 12H3"/></svg>
          </a>
          <a href="#strategies"
             class="inline-flex items-center gap-2 rounded-xl border border-black/15 px-6 py-3 text-[var(--ink)] font-semibold hover:bg-black/5">
            View OpenStrategies
          </a>
        </div>

        <p class="mt-3 text-xs text-slate-600">Start free. Upgrade anytime. Cancel anytime.</p>
      </div>
    </div>
  </div>
</section>

<section id="faqs" class="py-16 lg:py-20">
  <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6">
    <h2 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold tracking-tight text-[var(--ink)] mb-6">
      Frequently asked questions
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          What is AlgoHive?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          AlgoHive is a platform where you can discover, track and allocate to managed strategies across asset classes, paying only performance and transaction fees instead of AUM fees.
        </p>
      </details>

      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          How do fees work?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          You only pay performance fees when strategies deliver returns. A small transaction fee applies when you allocate or rebalance. There are no AUM fees — we only win when you do.
        </p>
      </details>

      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          Can I track multiple strategies?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          Yes. On the Freemium plan you can track one strategy. The Basic plan allows up to six, and Premium unlocks unlimited tracking.
        </p>
      </details>

      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          Do you offer advisory or just tools?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          Yes. Alongside our tools and data, you can book sessions with certified wealth advisors for personalised financial advice.
        </p>
      </details>

      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          Where is my data stored?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          Encrypted at rest and in transit with reputable cloud providers. You control connections and revocations.
        </p>
      </details>

      <details class="group rounded-2xl border border-black/10 bg-white p-4 open:shadow-sm">
        <summary class="flex cursor-pointer items-center justify-between gap-3 text-[var(--ink)] font-medium">
          Can I cancel anytime?
          <span class="ml-2 text-slate-400 group-open:rotate-180 transition-transform">&#9662;</span>
        </summary>
        <p class="mt-3 text-sm text-[var(--muted)]">
          Yep. Plans are month-to-month. You can downgrade or cancel from your account settings.
        </p>
      </details>
    </div>
  </div>
</section>

<footer class="border-t border-black/10 bg-white">
  <div class="mx-auto max-w-7xl px-3 sm:px-4 lg:px-6 py-10">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
      <div>
        <div class="flex items-center gap-2">
          <img src="https://static.wixstatic.com/media/ac771e_af06d86a7a1f4abd87e52e45f3bcbd96~mv2.png" class="h-7 w-auto" alt="AlgoHive">
          <span class="text-[var(--ink)] font-extrabold">AlgoHive</span>
        </div>
        <p class="mt-3 text-sm text-[var(--muted)]">
          Ready-made strategies, tracked and managed. Built to grow your wealth, not fees.
        </p>
      </div>

      <div>
        <h4 class="text-sm font-semibold text-[var(--ink)]">Product</h4>
        <ul class="mt-3 space-y-2 text-sm">
          <li><a href="#strategies" class="text-[var(--muted)] hover:text-[var(--ink)]">Strategies</a></li>
          <li><a href="#pricing" class="text-[var(--muted)] hover:text-[var(--ink)]">Pricing</a></li>
          <li><a href="#lending" class="text-[var(--muted)] hover:text-[var(--ink)]">Portfolio-backed credit</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-sm font-semibold text-[var(--ink)]">Company</h4>
        <ul class="mt-3 space-y-2 text-sm">
          <li><a href="who-we-are.html" class="text-[var(--muted)] hover:text-[var(--ink)]">About</a></li>
          <li><a href="how-we-work.html" class="text-[var(--muted)] hover:text-[var(--ink)]">How we work</a></li>
          <li><a href="#faqs" class="text-[var(--muted)] hover:text-[var(--ink)]">FAQs</a></li>
        </ul>
      </div>

      <div>
        <h4 class="text-sm font-semibold text-[var(--ink)]">Legal</h4>
        <ul class="mt-3 space-y-2 text-sm">
          <li><a href="https...pdf" class="text-[var(--muted)] hover:text-[var(--ink)]">Terms & Conditions</a></li>
          <li><a href="https...pdf" class="text-[var(--muted)] hover:text-[var(--ink)]">Privacy Policy</a></li>
          <li><a href="https...pdf" class="text-[var(--muted)] hover:text-[var(--ink)]">Advertising Policy</a></li>
          <li><a href="https...pdf" class="text-[var(--muted)] hover:text-[var(--ink)]">Risk Policy</a></li>
          <li><a href="https...pdf" class="text-[var(--muted)] hover:text-[var(--ink)]">Anti-Money Laundering & CTF</a></li>
        </ul>
      </div>
    </div>

    <div class="mt-8 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
      <p class="text-xs text-slate-500">© <span id="yr"></span> AlgoHive. All rights reserved.
AlgoHive (FSP 55118) is a registered Financial Services Provider. All asset classes carry investment risks, including the potential loss of capital. Past performance is not indicative of future results. Investors should carefully consider their financial situation and objectives before making any investment decisions. Invest responsibly.
 </p>

    </div>
  </div>
</footer>
  
<script nonce="ALGOHIVE">
  // Global scripts for all pages
  document.getElementById('yr').textContent = new Date().getFullYear();

  // Hamburger Menu Toggle
  const hamburgerButton = document.getElementById('hamburger-button');
  const mobileMenu = document.getElementById('mobile-menu');
  hamburgerButton.addEventListener('click', () => {
    mobileMenu.classList.toggle('hidden');
  });

  // Countdown Timer specific to home page
  (function(){
    const target = new Date('2025-10-21T21:00+02:00');
    const daysEl  = document.getElementById('cdDays');
    const hrsEl   = document.getElementById('cdHrs');
    const minsEl  = document.getElementById('cdMins');
    const secsEl  = document.getElementById('cdSecs');
    const labelEl = document.getElementById('cdLabel');

    if (!daysEl || !hrsEl || !minsEl || !secsEl || !labelEl) return;

    function update(){
      const now = new Date();
      let ms = target - now;
      if (ms <= 0){
        daysEl.textContent = '0';
        hrsEl.textContent  = '00';
        minsEl.textContent = '00';
        secsEl.textContent = '00';
        labelEl.textContent = 'Launched 🚀';
        if(interval) clearInterval(interval);
        return;
      }
      const d = Math.floor(ms / (1000*60*60*24));
      ms -= d * (1000*60*60*24);
      const h = Math.floor(ms / (1000*60*60));
      ms -= h * (1000*60*60);
      const m = Math.floor(ms / (1000*60));
      ms -= m * (1000*60);
      const s = Math.floor(ms / 1000);

      daysEl.textContent = d;
      hrsEl.textContent  = String(h).padStart(2, '0');
      minsEl.textContent = String(m).padStart(2, '0');
      secsEl.textContent = String(s).padStart(2, '0');
    }
    update();
    const interval = setInterval(update, 1000); // Update every second
  })();
</script>

<script type="module" nonce="ALGOHIVE">
  // --- Supabase ---
  const SUPABASE_URL = "https://aazofjsssobejhkyyiqv.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFhem9manNzc29iZWpoa3l5aXF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMTI1NDUsImV4cCI6MjA3MzY4ODU0NX0.guYlxaV5RwTlTVFoUhpER0KWEIGPay8svLsxMwyRUyM";
  
  // ***** THIS IS THE KEY FIX *****
  // Access createClient from the global `window.supabase` object loaded by the CDN script
  const { createClient } = window.supabase; 
  const db = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // --- DOM helpers ---
  const $  = (s)=>document.querySelector(s);
  const $$ = (s)=>document.querySelectorAll(s);

  // ***** MODIFIED: Updated els object for new HTML structure *****
  const els = {
    stratName: $('#stratName'), provider: $('#provider'), since: $('#since'),
    currency: $('#currency'), risk: $('#risk'), aum: $('#aum'), period: $('#period'),
    eqValue: $('#eqValue'), eqDelta: $('#eqDelta'),
    mBestDay: $('#mBestDay'), mWorstDay: $('#mWorstDay'), mAvgDaily: $('#mAvgDaily'),
    mPosDays: $('#mPosDays'), mTradingDays: $('#mTradingDays'), mYTD: $('#mYTD'),
    // Removed SVG els, added canvas
    equityChartCanvas: $('#equityChartCanvas'), 
    stratDesc: $('#stratDesc'), leftCard: $('#leftCard'),
    assetFilters: $('#assetFilters'), periodButtons: $$('.prd')
  };

  // --- State ---
  let STRATEGIES = [];
  let selectedAsset = 'All';
  let selectedPeriod = '6M'; // ***** MODIFIED: Default to 6M to match active button *****
  let activeStrategyIndex = 0;
  let chart; // ***** ADDED: Global var for Chart.js instance *****
  let currentLabels = []; // ***** ADDED: Global var for chart labels *****

  const monthFmt = new Intl.DateTimeFormat('en-GB', { month: 'short', day: 'numeric', year: '2-digit' });

  // --- Formatters ---
  const fmtPct = (v, dp=1) => (v==null || isNaN(+v)) ? '—' : `${+v>=0?'+':''}${(+v).toFixed(dp)}%`;
  const fmtInt = (v) => (v==null || isNaN(+v)) ? '—' : String(Math.round(+v)); // Use Math.round for safety

  // --- Fetch (matches your exact schema) ---
  async function fetchStrategies() {
    const { data, error } = await db
      .from('strategies')
      .select(`
        id, name, creator, inception_date, risk_level, aum, currency,
        strategy_description, asset_universe,
        strategy_metrics:strategy_metrics!strategy_metrics_strategy_id_fkey (
          asof_date, perf_summary, calendar_returns,
           series_6m, series_1y, series_all,
           series_ytd,
          live_equity, live_equity_ts, latest_eod_equity, latest_eod_date,
          portfolio_holdings, asset_allocation
        )
      `)
      .order('name', { ascending: true });

    if (error) {
      console.error(error);
      $('#stratName').textContent = 'Error loading strategies.';
      return [];
    }

    return (data || []).map(s => {
      // There’s only one metrics row per strategy_id (PK), but Supabase returns it as object already due to aliasing above.
      const m = s.strategy_metrics || {};
      const ps = m.perf_summary || {};

      // Helpers to keep UI clean even if JSON has strings
      const num = (x)=> (x==null || x==='') ? null : Number(x);
      const asDate = (x)=> x ? new Date(x) : null;

      // ***** This object is already correct from the previous fix *****
      return {
        id: s.id,
        name: s.name || 'Unnamed Strategy',
        provider: s.creator || 'AlgoHive Quant',
        inception_date: s.inception_date || null,
        since: s.inception_date ? `Live since ${new Date(s.inception_date).toLocaleDateString('en-CA')}` : '—',
        risk: s.risk_level || '',
        aum: (num(s.aum)!=null) ? `R${(num(s.aum)/1_000_000).toFixed(1)}m` : '—',
        currency: s.currency || 'USD',
        desc: s.strategy_description || 'No description provided.',
        asset: s.asset_universe || 'Other',

        // Time series (jsonb arrays)
        series_6m: Array.isArray(m.series_6m) ? m.series_6m : [],
        series_1y: Array.isArray(m.series_1y) ? m.series_1y : [],
        series_all: Array.isArray(m.series_all) ? m.series_all : [],
        series_ytd: Array.isArray(m.series_ytd) ? m.series_ytd : [], // ***** ADDED YTD *****

        // Holdings & allocation for future sections
        portfolio_holdings: Array.isArray(m.portfolio_holdings) ? m.portfolio_holdings : [],
        asset_allocation: Array.isArray(m.asset_allocation) ? m.asset_allocation : [],
        calendar_returns: Array.isArray(m.calendar_returns) ? m.calendar_returns : [],

        // --- Data for the 6-pack, matching strategy.html logic ---
        bestDay:     fmtPct(num(ps.best_day_pct), 2),
        worstDay:    fmtPct(num(ps.worst_day_pct), 2),
        avgDaily:    fmtPct(num(ps.avg_daily_return_pct), 2),
        posDaysPct:  (ps?.positive_days_pct == null || isNaN(ps.positive_days_pct)) ? '—' : `${Number(ps.positive_days_pct).toFixed(0)}%`,
        tradingDays: fmtInt(num(ps.total_days)),
        ytd:         fmtPct(num(ps.ytd_return_pct), 2)
      };
    });
  }

  // ***** ADDED: initChart and related functions from strategy.html *****
  
  // Helper to draw rounded rect path for tooltip
  function roundRectPath(ctx, x, y, w, h, r) {
      const radius = Math.min(r, h / 2, w / 2);
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + w - radius, y);
      ctx.quadraticCurveTo(x + w, y, x + w, y + radius);
      ctx.lineTo(x + w, y + h - radius);
      ctx.quadraticCurveTo(x + w, y + h, x + w - radius, y + h);
      ctx.lineTo(x + radius, y + h);
      ctx.quadraticCurveTo(x, y + h, x, y + h - radius);
      ctx.lineTo(x, y + radius);
      ctx.quadraticCurveTo(x, y, x + radius, y);
  }
  
  // Custom plugin for vertical seek line + hover pill
  const seekPlugin = {
      id: 'seekPlugin',
      afterDraw(chart, args, opts) {
          const { ctx, chartArea, tooltip } = chart;
          if (!tooltip || !tooltip._active || !tooltip._active.length) return;

          const activePoint = tooltip._active[0];
          const x = activePoint.element.x;
          const y = activePoint.element.y;

          if (x < chartArea.left || x > chartArea.right) return;
          const { top, bottom } = chartArea;
          ctx.save();
          ctx.setLineDash([4, 4]);
          ctx.strokeStyle = '#000';
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(x, top);
          ctx.lineTo(x, bottom);
          ctx.stroke();
          ctx.setLineDash([]);
          const triSize = 5;
          ctx.fillStyle = '#000';
          ctx.beginPath();
          ctx.moveTo(x, top - triSize);
          ctx.lineTo(x - triSize, top);
          ctx.lineTo(x + triSize, top);
          ctx.closePath();
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(x, bottom + triSize);
          ctx.lineTo(x - triSize, bottom);
          ctx.lineTo(x + triSize, bottom);
          ctx.closePath();
          ctx.fill();
          ctx.beginPath();
          ctx.arc(x, y, 5, 0, Math.PI * 2);
          ctx.fillStyle = '#fff';
          ctx.fill();
          ctx.lineWidth = 2;
          ctx.strokeStyle = '#1e293b'; // slate-800 ring
          ctx.stroke();

          const meta = window.__pfHoverMeta || {};
          const idx = activePoint.index;
          const dateLabel = (meta.labels && meta.labels[idx]) ? meta.labels[idx] : '';
          const valLabel = (meta.values && meta.values[idx] != null) ? meta.values[idx] : '—';
          
          const pillText = `${dateLabel}  ${valLabel}`;
          ctx.font = '600 12px Inter, system-ui, sans-serif';
          ctx.textBaseline = 'middle';
          const textW = ctx.measureText(pillText).width;
          const padX = 10, padY = 6;
          const pillW = textW + padX * 2, pillH = 28;
          const pillMargin = 8;
          const areaWidth = chartArea.right - chartArea.left;
          const areaHeight = chartArea.bottom - chartArea.top;
          let pillX = x - pillW / 2;
          const minPillX = chartArea.left + pillMargin;
          const maxPillX = chartArea.right - pillW - pillMargin;

          if (minPillX > maxPillX) {
              pillX = chartArea.left + (areaWidth - pillW) / 2;
              pillX = Math.max(chartArea.left, Math.min(pillX, chartArea.right - pillW));
          } else {
              if (pillX < minPillX) pillX = minPillX;
              if (pillX > maxPillX) pillX = maxPillX;
          }
          let pillY = y - pillH - 10; // above point
          const minPillY = chartArea.top + pillMargin;
          const maxPillY = chartArea.bottom - pillH - pillMargin;

          if (minPillY > maxPillY) {
              pillY = chartArea.top + (areaHeight - pillH) / 2;
              pillY = Math.max(chartArea.top, Math.min(pillY, chartArea.bottom - pillH));
          } else {
              if (pillY < minPillY) {
                  const belowY = y + 10;
                  const roomBelow = belowY + pillH <= chartArea.bottom - pillMargin;
                  pillY = roomBelow ? Math.min(Math.max(belowY, minPillY), maxPillY) : minPillY;
              }
              if (pillY > maxPillY) pillY = maxPillY;
          }
          ctx.fillStyle = '#000';
          ctx.beginPath();
          roundRectPath(ctx, pillX, pillY, pillW, pillH, 14);
          ctx.fill();

          const pctIsPos = valLabel.startsWith('+');
          ctx.fillStyle = pctIsPos ? '#4ade80' : (valLabel.startsWith('—') || valLabel === '0.00%') ? '#fff' : '#f87171';
          ctx.textAlign = 'center';
          const textCenter = pillX + pillW / 2;
          ctx.fillText(pillText, textCenter, pillY + pillH / 2);
          ctx.restore();
      }
  };
  
  // Global var for hover plugin
  window.__pfHoverMeta = { labels: [], values: [] };

  function initChart() {
      const ctx = els.equityChartCanvas?.getContext('2d');
      if (!ctx) return;

      // ***** MODIFIED: Changed gradient colors to match strategy.html *****
      const gradient = ctx.createLinearGradient(0, 0, 0, 320); // 320px height
      gradient.addColorStop(0, 'rgba(85,107,47,0.35)'); // #556B2F
      gradient.addColorStop(1, 'rgba(85,107,47,0.06)'); // #556B2F

      chart = new Chart(ctx, {
          type: 'line',
          data: {
              labels: [],
              datasets: [{
                  data: [],
                  tension: .35,
                  borderWidth: 2,
                  // ***** MODIFIED: Changed border color to match strategy.html *****
                  borderColor: '#556B2F', 
                  backgroundColor: gradient,
                  fill: true,
                  pointRadius: 0,
                  pointHitRadius: 20 
              }]
          },
          options: {
              responsive: true,
              maintainAspectRatio: false,
              interaction: {
                  mode: 'index',
                  intersect: false
              },
              plugins: {
                  legend: { display: false },
                  tooltip: {
                      enabled: false // Use custom seekPlugin
                  }
              },
              scales: {
                  x: {
                      display: true,
                      ticks: { maxTicksLimit: 6, color: '#94a3b8' },
                      grid: { display: false }
                  },
                  y: {
                      display: true,
                      ticks: {
                          color: '#94a3b8',
                          maxTicksLimit: 5, // A bit more room
                          callback: v => v // Default, will be overridden
                      }
                  }
              }
          },
          plugins: [seekPlugin] // Enable the hover plugin
      });
  }

  // --- Chart ---
  // ***** MODIFIED: This function now updates Chart.js with the correct logic *****
  function drawChart(equityVals, dates){
      if (!chart) return; // Guard if chart isn't initialized
      
      const pct = (n,dp=1)=>`${n>=0?'+':''}${n.toFixed(dp)}%`;
      
      // `equityVals` is the cumulative level, e.g. [100, 101.5, 103.2]
      // `base` is the starting level, e.g. 100
      const base = (equityVals && equityVals.length > 0) ? equityVals[0] : 100;
      
      // Calculate final percentage growth from start to end
      const lastPct = ((equityVals.at(-1) || base) - base) / base * 100;
      
      // Main chart value
      els.eqValue.textContent = pct(lastPct, 2); 
      // ***** MODIFIED: Set color based on performance *****
      els.eqValue.style.color = lastPct >= 0 ? '#16a34a' : '#dc2626';
      
      els.eqDelta.textContent = ''; 
      els.eqDelta.className = 'inline-flex items-center rounded-full px-2 py-0.5 text-[11px] hidden';

      // Update chart instance
      const chartLabels = dates.map(d => monthFmt.format(new Date(d))); // Ensure it's a Date object
      chart.data.labels = chartLabels;
      chart.data.datasets[0].data = equityVals; // PLOT THE CUMULATIVE LEVEL

      // Update Y-axis ticks to show relative %
      chart.options.scales.y.ticks.callback = v => {
          const relPct = ((v - base) / base) * 100;
          return pct(relPct, 0);
      };

      // Update hover metadata
      window.__pfHoverMeta = {
          labels: chartLabels,
          values: equityVals.map(v => pct(((v - base) / base) * 100, 2))
      };
      
      chart.update();
  }

  // --- Series selection (works for your JSON shapes) ---
  function periodSeries(s){
    let raw=[];
    // ***** MODIFIED: This logic is now correct *****
    switch (selectedPeriod){
      case '6M': raw=s.series_6m; break;
      case '1Y': raw=s.series_1y; break;
      case 'ALL': raw=s.series_all; break;
      // ***** ADDED: YTD case *****
      case 'YTD': raw=s.series_ytd; break; 
      default: raw=s.series_6m; break; // Default to 6M
    }
    // ***** END MODIFICATION *****
    
    if (!Array.isArray(raw) || raw.length===0){
      return { eq:[100], dates:[ new Date(s.inception_date || Date.now()) ] };
    }

    const first = raw[0] || {};
    // intraday equity: { ts, equity }
    if ('ts' in first && 'equity' in first){
      const base = Number(first.equity)||1;
      const eq = raw.map(p=> 100*((Number(p.equity)||0)/base) );
      const dates = raw.map(p=> new Date(p.ts));
      return { eq, dates };
    }

    // periodic returns: { pct, date } OR { pct, label:"Jan 2025" }
    const labelToDate = (label)=>{
      if (!label) return null;
      const [mon,yr] = label.split(' ');
      const mi = new Date(Date.parse(`${mon} 1, 2000`)).getMonth();
      const d = new Date(Number(yr), mi+1, 0);
      return isNaN(d.getTime()) ? null : d;
    };

    const rows = raw.map(r=>{
      const d = r.date ? new Date(r.date) : labelToDate(r.label);
      // ***** THIS IS THE CUMULATIVE CALCULATION FIX *****
      const pct = (r.pct==null)?0:Number(r.pct); 
      return d ? { d, pct } : null;
    }).filter(Boolean);

    if (!rows.length) return { eq:[100], dates:[ new Date(s.inception_date || Date.now()) ] };
    
    // This creates the cumulative equity curve, e.g., [100, 101.2, 99.8, 103.4]
    const eq = rows.reduce((arr, r)=>{ arr.push(arr.at(-1)*(1+(r.pct||0))); return arr; }, [100]);
    const start = new Date(rows[0].d); start.setDate(start.getDate()-1);
    const dates = [start, ...rows.map(r=>r.d)];
    return { eq, dates };
  }

  // --- Render ---
  function render(){
    const list = STRATEGIES.filter(x=> selectedAsset==='All' || x.asset===selectedAsset );
    if (!list.length){
      els.stratName.textContent = `No strategies found for "${selectedAsset}"`;
      // ***** MODIFIED: Clear all 6 fields on error *****
      ['provider','since','currency','risk','aum','period','mBestDay','mWorstDay','mAvgDaily','mPosDays','mTradingDays','mYTD','stratDesc'].forEach(k=>els[k]&&(els[k].textContent='—'));
      drawChart([],[]); updateNav(0,0); markActive(); return;
    }
    if (activeStrategyIndex>=list.length) activeStrategyIndex=0;

    const s = list[activeStrategyIndex];
    
    // Get the correct data series based on the selected period
    const { eq, dates } = periodSeries(s); 

    els.stratName.textContent = s.name;
    els.provider.textContent  = s.provider;
    els.since.textContent     = s.since;
    els.currency.textContent  = s.currency || 'USD';
    
    // ***** MODIFIED: Hide AUM if it's 'R0.0m' or '—'
    if (s.aum && s.aum !== 'R0.0m' && s.aum !== '—') {
      els.aum.textContent = s.aum;
      els.aum.classList.remove('hidden');
    } else {
      els.aum.classList.add('hidden');
    }
    
    els.stratDesc.textContent = s.desc;

    const r = (s.risk||'').toLowerCase();
    // ***** MODIFIED: This line removes the redundant "Risk " prefix *****
    els.risk.textContent = s.risk || '—';
    // ***** MODIFIED: Added all risk level color mappings *****
    els.risk.className = 'inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ' +
      (r.includes('very high') ? 'bg-red-100 text-red-800' :
       r.includes('high') ? 'bg-red-50 text-red-700' :
       (r.includes('med') || r.includes('moderate'))  ? 'bg-amber-50 text-amber-700' :
       r.includes('conservative') ? 'bg-green-50 text-green-700' :
                            'bg-slate-50 text-slate-700');

    // ***** MODIFIED: Populate the correct 6 fields *****
    els.mBestDay.textContent = s.bestDay;
    els.mWorstDay.textContent = s.worstDay;
    els.mAvgDaily.textContent = s.avgDaily;
    els.mPosDays.textContent = s.posDaysPct;
    els.mTradingDays.textContent = s.tradingDays;
    // ***** MODIFIED: Use the pre-fetched s.ytd value *****
    els.mYTD.textContent = s.ytd;
    
    // ***** ADDED: Colorize the summary box values *****
    const red = '#dc2626'; // Tailwind's red-600
    const green = '#16a34a'; // Tailwind's green-600
    const defaultColor = 'var(--ink)';

    els.mBestDay.style.color = (s.bestDay && s.bestDay.startsWith('+')) ? green : defaultColor;
    els.mWorstDay.style.color = (s.worstDay && s.worstDay.startsWith('-')) ? red : defaultColor;
    els.mAvgDaily.style.color = (s.avgDaily && s.avgDaily.startsWith('-')) ? red : (s.avgDaily && s.avgDaily.startsWith('+')) ? green : defaultColor;
    els.mPosDays.style.color = defaultColor; // This is just a %, no color needed
    els.mTradingDays.style.color = defaultColor;
    // ***** MODIFIED: Use the pre-fetched s.ytd for coloring *****
    els.mYTD.style.color = (s.ytd && s.ytd.startsWith('-')) ? red : (s.ytd && s.ytd.startsWith('+')) ? green : defaultColor;
    // ***** END OF ADDED BLOCK *****

    els.period.textContent = selectedPeriod==='ALL' ? 'All time' : selectedPeriod;

    drawChart(eq, dates); // This now updates the Chart.js instance

    els.leftCard.classList.remove('swap-in'); void els.leftCard.offsetWidth; els.leftCard.classList.add('swap-in');

    updateNav(activeStrategyIndex, list.length);
    markActive();
  }

  function renderAssetFilters(){
    const assets = ['All', ...new Set(STRATEGIES.map(s=>s.asset).filter(Boolean))];
    els.assetFilters.innerHTML = assets.map(a=>`
      <button class="asset-tag px-3 py-1.5 rounded-full text-xs font-medium text-[var(--ink)] hover:bg-black/5" data-asset="${a}">${a}</button>
    `).join('');
    $$('.asset-tag').forEach(b=>{
      b.addEventListener('click', ()=>{ selectedAsset=b.dataset.asset; activeStrategyIndex=0; render(); });
    });
  }

  function updateNav(i,n){ /* Navigation buttons removed */ }
  function markActive(){ $$('.asset-tag').forEach(b=>b.classList.toggle('tag-active', b.dataset.asset===selectedAsset));
                         els.periodButtons.forEach(b=>b.classList.toggle('prd-active', b.dataset.period===selectedPeriod)); }

  // --- Init ---
  async function main(){
    initChart(); // ***** ADDED: Initialize the chart structure *****
    STRATEGIES = await fetchStrategies();
    if (STRATEGIES.length){ renderAssetFilters(); render(); }
    else { $('#stratName').textContent = 'No strategies available.'; updateNav(0,0); }

    els.periodButtons.forEach(b=> b.addEventListener('click', ()=>{ 
      selectedPeriod=b.dataset.period||'ALL'; 
      render(); 
    }));
  }
  main();
</script>

</body> 
</html>
